{% extends "base.html" %}

{% block content %}
    <h1>üìà Model Performance and Data Insights</h1>
    <p style="color: rgba(255,255,255,0.9); font-size: 1.1em; margin-bottom: 30px;">
        Comprehensive analysis of model performance and data insights from the movie recommendation system.
    </p>

    <div class="card" style="margin-bottom: 30px;">
        <h2 style="margin-top: 0;">1. Model Comparison (Regression)</h2>
        <p>Comparing the performance of the three regression algorithms used to predict the continuous rating.</p>
        <div style="overflow-x: auto; margin-top: 20px;">
            <table>
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>RMSE (Lower is Better)</th>
                        <th>MAE (Lower is Better)</th>
                        <th>Performance</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in comparison_data %}
                    <tr>
                        <td><strong>{{ item.Model }}</strong></td>
                        <td>{{ "%.4f"|format(item.RMSE) }}</td>
                        <td>{{ "%.4f"|format(item.MAE) }}</td>
                        <td>
                            {% if loop.index == 1 %}
                                <span style="color: #28a745; font-weight: bold;">üèÜ Best</span>
                            {% elif loop.index == 2 %}
                                <span style="color: #ffc107;">ü•à Second</span>
                            {% else %}
                                <span style="color: #6c757d;">ü•â Third</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <div class="card" style="margin-bottom: 30px;">
        <h2 style="margin-top: 0;">2. Key Visualizations</h2>
        <p>Charts generated from the initial data understanding and pre-processing phase:</p>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-top: 20px;">
            <div class="card" style="margin: 0;">
                <h3 style="margin-top: 0; color: #667eea;">üìä User Rating Distribution</h3>
                <p style="color: #6c757d; margin-bottom: 15px;">
                    This visualization shows the distribution of user ratings across all movies in the dataset. 
                    It reveals user rating patterns and helps understand the overall sentiment distribution, 
                    which is crucial for building an effective recommendation system.
                </p>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: center;">
                    <img src="{{ url_for('serve_model_artifact', filename='user_rating distribution.png') }}" 
                         alt="User Rating Distribution" 
                         style="max-width: 100%; height: auto; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                </div>
            </div>

            <div class="card" style="margin: 0;">
                <h3 style="margin-top: 0; color: #f5576c;">üìà Rating Trends Over Time</h3>
                <p style="color: #6c757d; margin-bottom: 15px;">
                    This chart displays how movie ratings have evolved over time. It helps identify temporal 
                    patterns in user behavior and can reveal trends in movie quality or changing user preferences 
                    across different time periods.
                </p>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: center;">
                    <img src="{{ url_for('serve_model_artifact', filename='rating_trends_overtime.png') }}" 
                         alt="Rating Trends Over Time" 
                         style="max-width: 100%; height: auto; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                </div>
            </div>

            <div class="card" style="margin: 0;">
                <h3 style="margin-top: 0; color: #764ba2;">‚öñÔ∏è User Rating Bias Analysis</h3>
                <p style="color: #6c757d; margin-bottom: 15px;">
                    This visualization examines potential biases in user rating behavior. Understanding rating 
                    biases is essential for normalizing ratings and ensuring fair recommendations across different 
                    user segments and movie categories.
                </p>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; text-align: center;">
                    <img src="{{ url_for('serve_model_artifact', filename='user_rating_bias.png') }}" 
                         alt="User Rating Bias" 
                         style="max-width: 100%; height: auto; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                </div>
            </div>
        </div>
    </div>

    <div class="card" style="margin-bottom: 30px;">
        <h2 style="margin-top: 0;">3. Dataset Statistics</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
            <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <h3 style="color: #667eea; font-size: 2em; margin: 0;">{{ comparison_data|length }}</h3>
                <p style="margin: 5px 0 0 0; color: #6c757d;">Models Trained</p>
            </div>
            <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <h3 style="color: #667eea; font-size: 2em; margin: 0;">20+</h3>
                <p style="margin: 5px 0 0 0; color: #6c757d;">Genre Features</p>
            </div>
            <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <h3 style="color: #667eea; font-size: 2em; margin: 0;">16K+</h3>
                <p style="margin: 5px 0 0 0; color: #6c757d;">Qualified Movies</p>
            </div>
        </div>
    </div>

    <div class="card">
        <h2 style="margin-top: 0;">4. Methodology & Conclusion</h2>
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 15px;">
            <h3 style="margin-top: 0;">Methodology</h3>
            <p>
                We trained three regression models (<strong>Random Forest Regressor</strong>, <strong>Ridge Regression</strong>, 
                and <strong>K-Nearest Neighbors</strong>) on One-Hot-Encoded genre features and log-transformed movie popularity. 
                The target variable was the <strong>average movie rating</strong> calculated from user ratings.
            </p>
            <ul style="margin: 15px 0; padding-left: 25px; color: #495057;">
                <li>Movies with fewer than 50 ratings were filtered out for robustness</li>
                <li>Genre features were one-hot encoded to create binary indicators</li>
                <li>Rating count was log-transformed to normalize popularity</li>
                <li>Models were evaluated using RMSE and MAE metrics</li>
            </ul>
            
            <h3 style="margin-top: 25px;">Conclusion</h3>
            <p>
                The <strong>{{ comparison_data[0].Model }}</strong> model achieved the lowest error metrics 
                (RMSE: <strong>{{ "%.4f"|format(comparison_data[0].RMSE) }}</strong>, 
                MAE: <strong>{{ "%.4f"|format(comparison_data[0].MAE) }}</strong>), 
                indicating it is the most robust predictor of inherent movie quality based on content features alone.
            </p>
            <p style="margin-top: 15px; padding: 15px; background: white; border-left: 4px solid #667eea; border-radius: 4px;">
                <strong>üí° Insight:</strong> This model can effectively predict movie ratings using only genre information 
                and popularity metrics, making it useful for this content-based recommendation systems.
            </p>
        </div>
    </div>

{% endblock %}